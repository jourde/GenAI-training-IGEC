<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DigComp 3.0 Mapping Tool - Light Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        :root {
            --md-primary: #546E7A;
            --md-on-primary: #FFFFFF;
            --md-background: #F8F9FA;
            --md-surface: #FFFFFF;
            --md-surface-variant: #F1F3F4;
            --md-on-surface: #3C4043;
            --md-outline: #DADCE0;
            --md-secondary: #70757A;
            --shadow-soft: 0 1px 2px 0 rgba(60,64,67,.3), 0 1px 3px 1px rgba(60,64,67,.15);
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--md-background);
            color: var(--md-on-surface);
            margin: 0; padding: 40px 20px;
            display: flex; justify-content: center;
        }

        .container {
            max-width: 900px; width: 100%;
            background: var(--md-surface);
            padding: 40px; border-radius: 16px;
            box-shadow: var(--shadow-soft);
            box-sizing: border-box;
        }

        header { margin-bottom: 40px; }
        h1 { font-size: 28px; font-weight: 500; color: var(--md-primary); margin: 0; }
        .subtitle { font-size: 15px; color: var(--md-secondary); margin-top: 8px; }

        .card {
            border: 1px solid var(--md-outline);
            border-radius: 12px; padding: 24px; margin-bottom: 32px;
            background: #FFFFFF;
        }

        .section-header {
            font-size: 14px; font-weight: 700; color: var(--md-primary);
            text-transform: uppercase; letter-spacing: 0.8px;
            margin-bottom: 24px; display: flex; align-items: center;
        }

        .section-header .material-icons { margin-right: 12px; font-size: 20px; }

        .form-group { margin-bottom: 20px; }
        label { display: block; font-size: 12px; font-weight: 700; margin-bottom: 8px; color: var(--md-secondary); }

        input, select, textarea {
            width: 100%; padding: 12px 16px; border: 1px solid var(--md-outline);
            border-radius: 8px; font-size: 15px; box-sizing: border-box;
            background: var(--md-background); color: var(--md-on-surface);
            transition: all 0.2s ease;
            font-family: inherit;
        }

        /* Resizable activity field with 3 lines default */
        textarea#task {
            resize: vertical;
            min-height: 85px; 
        }

        input:focus, select:focus, textarea:focus {
            outline: none; border: 1.5px solid var(--md-primary); background: #FFF;
        }

        .mapping-grid {
            display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 16px; margin-bottom: 20px;
        }

        .competence-block {
            padding: 24px; margin-bottom: 24px; background: #FAFAFA;
            border-radius: 8px; border-left: 4px solid var(--md-outline);
        }

        .competence-block.required-block {
            border-left-color: var(--md-primary);
            background: #FFFFFF;
            border: 1px solid var(--md-outline);
            border-left: 4px solid var(--md-primary);
        }

        .optional-tag {
            font-size: 10px;
            color: var(--md-secondary);
            font-weight: 400;
            margin-left: 8px;
            text-transform: none;
        }

        .btn-primary {
            background: var(--md-primary); color: var(--md-on-primary); border: none;
            padding: 16px 32px; border-radius: 8px; font-weight: 500;
            text-transform: uppercase; cursor: pointer; width: 100%;
            letter-spacing: 1px; transition: 0.2s;
            display: flex; align-items: center; justify-content: center;
        }

        .btn-primary:hover { background: #455A64; filter: brightness(0.95); }

        #summary-display {
            display: none; background: #F1F3F4; color: #3C4043;
            padding: 24px; border-radius: 12px; margin-top: 40px;
            font-family: 'Roboto Mono', monospace; position: relative;
            line-height: 1.5; border: 1px solid var(--md-outline);
            font-size: 14px;
        }

        .copy-button {
            position: absolute; top: 12px; right: 12px;
            background: #FFFFFF; color: var(--md-primary);
            border: 1px solid var(--md-outline); padding: 6px 14px;
            border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 700;
        }

        .copy-button:hover { background: var(--md-surface-variant); }

        @media (max-width: 800px) { .mapping-grid { grid-template-columns: 1fr; } }

        /* â”€â”€ Legal footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .legal-footer {
            text-align: center;
            padding: 32px 0 0;
        }
        .legal-footer-btn {
            appearance: none;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 11px;
            color: var(--md-secondary);
            text-decoration: underline;
            text-underline-offset: 2px;
            padding: 4px 8px;
            border-radius: 6px;
            font-family: inherit;
            transition: color .15s;
        }
        .legal-footer-btn:hover { color: var(--md-on-surface); }
        .legal-footer-btn:focus { outline: 2px solid var(--md-primary); outline-offset: 2px; }

        /* â”€â”€ Legal modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .legal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 1000;
            background: rgba(0,0,0,.45);
            align-items: center;
            justify-content: center;
        }
        .legal-overlay.open { display: flex; }
        .legal-modal {
            background: var(--md-surface);
            border-radius: 12px;
            box-shadow: 0 8px 40px rgba(0,0,0,.18);
            width: min(640px, 92vw);
            max-height: 82vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .legal-modal-header {
            background: var(--md-primary);
            color: var(--md-on-primary);
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .legal-modal-header h2 {
            margin: 0;
            font-size: 14px;
            font-weight: 700;
        }
        .legal-modal-close {
            appearance: none;
            background: none;
            border: none;
            color: var(--md-on-primary);
            cursor: pointer;
            font-size: 16px;
            line-height: 1;
            padding: 4px 8px;
            border-radius: 6px;
            transition: background .15s;
        }
        .legal-modal-close:hover { background: rgba(255,255,255,.15); }
        .legal-modal-close:focus { outline: 2px solid var(--md-on-primary); outline-offset: 2px; }
        .legal-modal-body {
            overflow-y: auto;
            padding: 20px 24px;
            font-size: 13px;
            line-height: 1.7;
            color: var(--md-on-surface);
        }
        .legal-modal-body h3 {
            font-size: 11px;
            font-weight: 700;
            color: var(--md-primary);
            margin: 18px 0 5px;
            text-transform: uppercase;
            letter-spacing: .6px;
        }
        .legal-modal-body h3:first-child { margin-top: 0; }
        .legal-modal-body p { margin: 0 0 8px; }
        .legal-modal-body ul { margin: 4px 0 8px; padding-left: 18px; }
        .legal-modal-body ul li { margin-bottom: 3px; }
        .legal-modal-body a { color: var(--md-primary); }
    </style>
</head>
<body>

<div class="container" role="main">
    <header>
        <h1>DigComp 3.0 Mapping Exercise</h1>
        <p class="subtitle">GenAI Integration Activity Mapping</p>
    </header>

    <form id="mappingForm">
        <div class="card">
            <div class="section-header"><span class="material-icons">description</span>Step 1: Task</div>
            <div class="form-group">
                <label for="task">Your Concrete Activity</label>
                <textarea id="task" rows="3" placeholder="Describe the concrete IGEC task where GenAI could be used..." required aria-label="Describe your concrete task"></textarea>
            </div>
        </div>

        <div class="card">
            <div class="section-header"><span class="material-icons">account_tree</span>Step 2: Mappings</div>
            <div id="mappingContainer"></div>
        </div>

        <button type="submit" class="btn-primary">
            <span class="material-icons" style="margin-right: 12px;">assignment_turned_in</span>
            Generate Mapping Summary
        </button>
    </form>

    <div id="summary-display">
        <button class="copy-button" onclick="copyText()">COPY SUMMARY</button>
        <div id="summaryText"></div>
    </div>

    <div class="legal-footer">
        <button class="legal-footer-btn" id="btnLegalOpen"
            aria-haspopup="dialog" type="button"
            onclick="openLegalModal()">
            Legal Notice &amp; Privacy Policy
        </button>
    </div>
</div>

<!-- Legal Notice modal -->
<div class="legal-overlay" id="legalOverlay"
    role="dialog" aria-modal="true" aria-labelledby="legalModalTitle">
    <div class="legal-modal">
        <div class="legal-modal-header">
            <h2 id="legalModalTitle">Legal Notice &amp; Privacy Policy</h2>
            <button class="legal-modal-close" id="btnLegalClose"
                aria-label="Close legal notice" type="button"
                onclick="closeLegalModal()">&#x2715;</button>
        </div>
        <div class="legal-modal-body">
            <h3>1. Publisher &amp; Hosting</h3>
            <p><strong>Publisher:</strong> This application is published by FranÃ§ois Jourde.</p>
            <p><strong>Hosting:</strong> This site is hosted by GitHub Inc. Address: 88 Colin P. Kelly Jr. Street, San Francisco, CA 94107, United States.</p>

            <h3>2. How the Application Works &amp; Personal Data</h3>
            <p>This application was designed following a <em>Privacy by Design</em> approach (privacy by default).</p>
            <p><strong>No data collection:</strong> The application runs entirely in <em>client-side</em> mode in your web browser.</p>
            <ul>
                <li>No data entered or processed in the application is transmitted to the publisher.</li>
                <li>No data is stored on a remote server (cloud database).</li>
            </ul>
            <p>All information remains strictly confined to your device (computer or smartphone).</p>

            <h3>3. Local Storage</h3>
            <p>To enable the application to function (e.g. saving your preferences or progress), we use your browser's <em>localStorage</em> technology.</p>
            <ul>
                <li>This data is stored only on your device.</li>
                <li>It is accessible only to you.</li>
                <li>These mechanisms are purely technical and functional, and are therefore exempt from prior consent (no cookie banner required).</li>
            </ul>
            <p>You can delete this data at any time by clearing your browser cache.</p>

            <h3>4. Technical Data (Server Logs)</h3>
            <p>Although the publisher does not collect any data, the hosting infrastructure (GitHub Pages) may collect standard technical data when you connect (such as your IP address and browser type) in connection logs, for security and service reliability purposes.</p>
            <p>The publisher of this site does not have access to this raw data. For more information, you may consult <a href="https://docs.github.com/en/site-policy/privacy-policies/github-general-privacy-statement" target="_blank" rel="noopener">GitHub's Privacy Statement</a>.</p>

            <h3>5. Third-Party Services</h3>
            <p>This site may load technical resources (fonts, JavaScript libraries) from third-party servers (e.g. Google Fonts). These services may technically have access to your IP address when these resources are loaded.</p>

            <h3>6. Contact</h3>
            <p>For any questions regarding the application, you may contact the publisher via <a href="https://github.com/jourde" target="_blank" rel="noopener">github.com/jourde</a>.</p>
        </div>
    </div>
</div>

<script>
    // DigComp 3.0 Framework Data
    const areas = [
        { title: "1: Information search, evaluation and management", comps: ["1.1 Browsing, searching and filtering information", "1.2 Evaluating information", "1.3 Managing information"] },
        { title: "2: Communication and collaboration", comps: ["2.1 Interacting through and with digital technologies", "2.2 Sharing through digital technologies", "2.3 Engaging in citizenship through digital technologies", "2.4 Collaborating through digital technologies", "2.5 Digital behaviour", "2.6 Managing digital identity"] },
        { title: "3: Content creation", comps: ["3.1 Developing digital content", "3.2 Integrating and re-elaborating digital content", "3.3 Copyright and licences", "3.4 Computational thinking and programming"] },
        { title: "4: Safety, wellbeing and responsible use", comps: ["4.1 Protecting devices", "4.2 Protecting personal data and privacy", "4.3 Supporting wellbeing", "4.4 Environmental impacts of digital technologies"] },
        { title: "5: Problem identification and solving", comps: ["5.1 Identifying and solving technical problems", "5.2 Identifying needs and digital technological responses", "5.3 Identifying creative solutions using digital technologies", "5.4 Identifying and addressing digital competence needs"] }
    ];

    const profLevels = ["Basic", "Intermediate", "Advanced", "Highly advanced"];
    const aiEvidence = ["AI-Explicit", "AI-Implicit", "AI not Implicit or Explicit"];

    function setup() {
        const wrap = document.getElementById('mappingContainer');
        for (let i = 1; i <= 3; i++) {
            const isRequired = i === 1;
            const div = document.createElement('div');
            div.className = `competence-block ${isRequired ? 'required-block' : ''}`;
            div.innerHTML = `
                <div style="font-size:11px; font-weight:700; color:#546E7A; margin-bottom:12px; text-transform:uppercase;">
                    Priority Mapping #${i} ${isRequired ? '' : '<span class="optional-tag">(Optional)</span>'}
                </div>
                <div class="mapping-grid">
                    <div class="form-group">
                        <label>Competence</label>
                        <select class="sel-comp" ${isRequired ? 'required' : ''}>
                            <option value="">Choose...</option>
                            ${areas.map(a => `<optgroup label="${a.title}">${a.comps.map(c => `<option value="${c}">${c}</option>`).join('')}</optgroup>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Proficiency</label>
                        <select class="sel-lvl" ${isRequired ? 'required' : ''}>
                            <option value="">Choose...</option>
                            ${profLevels.map(l => `<option value="${l}">${l}</option>`).join('')}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>AI Evidence</label>
                        <select class="sel-evid" ${isRequired ? 'required' : ''}>
                            <option value="">Choose...</option>
                            ${aiEvidence.map(e => `<option value="${e}">${e}</option>`).join('')}
                        </select>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom:0;">
                    <label>Justification</label>
                    <textarea class="txt-just" rows="2" placeholder="Briefly explain why..." ${isRequired ? 'required' : ''}></textarea>
                </div>
            `;
            wrap.appendChild(div);
        }
    }

    document.getElementById('mappingForm').onsubmit = (e) => {
        e.preventDefault();
        const taskVal = document.getElementById('task').value;
        let summary = `ðŸ“ DIGCOMP 3.0 MAPPING EXERCISE\n`;
        summary += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
        summary += `TASK: ${taskVal}\n\n`;

        const c_sels = document.querySelectorAll('.sel-comp');
        const l_sels = document.querySelectorAll('.sel-lvl');
        const e_sels = document.querySelectorAll('.sel-evid');
        const j_txts = document.querySelectorAll('.txt-just');

        let validMappings = 0;
        c_sels.forEach((s, idx) => {
            // Only include in summary if a competence has been selected
            if (s.value) {
                validMappings++;
                summary += `[Mapping ${idx + 1}]\n`;
                summary += `â€¢ Competence: ${s.value}\n`;
                summary += `â€¢ Level: ${l_sels[idx].value}\n`;
                summary += `â€¢ Evidence: ${e_sels[idx].value}\n`;
                summary += `â€¢ Why: ${j_txts[idx].value}\n\n`;
            }
        });

        document.getElementById('summaryText').innerText = summary;
        document.getElementById('summary-display').style.display = 'block';
        window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    };

    function copyText() {
        navigator.clipboard.writeText(document.getElementById('summaryText').innerText);
        alert("Summary copied to clipboard!");
    }

    setup();

    // Legal modal
    function openLegalModal() {
        document.getElementById("legalOverlay").classList.add("open");
        document.getElementById("btnLegalClose").focus();
        document.addEventListener("keydown", legalKeyHandler);
    }
    function closeLegalModal() {
        document.getElementById("legalOverlay").classList.remove("open");
        document.getElementById("btnLegalOpen").focus();
        document.removeEventListener("keydown", legalKeyHandler);
    }
    function legalKeyHandler(e) {
        if (e.key === "Escape") { closeLegalModal(); return; }
        if (e.key === "Tab") {
            const overlay = document.getElementById("legalOverlay");
            const focusable = [...overlay.querySelectorAll("a[href], button")];
            const first = focusable[0], last = focusable[focusable.length - 1];
            if (e.shiftKey && document.activeElement === first) {
                e.preventDefault(); last.focus();
            } else if (!e.shiftKey && document.activeElement === last) {
                e.preventDefault(); first.focus();
            }
        }
    }
    document.getElementById("legalOverlay").addEventListener("click", (e) => {
        if (e.target === e.currentTarget) closeLegalModal();
    });
</script>

</body>
</html>
